{"version":3,"file":"ModForm-b2319bd6.js","sources":["../../../../../src/lib/models/mods.ts","../../../../../src/lib/components/mods/ModForm.svelte"],"sourcesContent":["import * as zod from 'zod';\n\nexport type ModData = {\n  name: string;\n  mod_reference: string;\n  short_description: string;\n  full_description?: string;\n  logo?: string;\n  source_url?: string;\n};\n\nexport const modSchema = zod.object({\n  name: zod.string().min(3).max(32),\n  mod_reference: zod\n    .string()\n    .min(3)\n    .max(32)\n    .regex(/^([a-zA-Z][a-zA-Z0-9_]*)$/)\n    .refine(async () => {\n      // TODO Check if mod reference exists\n      return true;\n    }),\n  short_description: zod.string().min(16).max(128),\n  full_description: zod.optional(zod.string()),\n  logo: zod.optional(zod.any().refine((logo) => 'name' in logo && 'size' in logo && 'type' in logo)),\n  source_url: zod.string().url().optional().or(zod.literal(''))\n});\n","<script lang=\"ts\">\n  import { createForm } from 'felte';\n  import { validator } from '@felte/validator-zod';\n  import { svelteReporter, ValidationMessage } from '@felte/reporter-svelte';\n  import type { ModData } from '$lib/models/mods';\n  import { modSchema } from '$lib/models/mods';\n  import { trimNonSchema } from '$lib/utils/forms';\n  import { markdown } from '$lib/utils/markdown';\n\n  export let onSubmit: (data: ModData) => void;\n  export let initialValues: ModData | undefined = undefined;\n  export let submitText = 'Create';\n\n  export let editing = false;\n\n  const { form, data } = createForm<ModData>({\n    initialValues: initialValues,\n    extend: [validator, svelteReporter],\n    validateSchema: modSchema,\n    onSubmit: (data) => onSubmit(trimNonSchema(data, modSchema))\n  });\n\n  $: preview = ($data.full_description as string) || '';\n</script>\n\n<form use:form>\n  <div class=\"grid grid-flow-row gap-6\">\n    <div class=\"grid grid-flow-row gap-2\">\n      <label for=\"name\">Name:</label>\n      <input id=\"name\" class=\"base-input\" name=\"name\" type=\"text\" placeholder=\"Name\" />\n      <ValidationMessage for=\"name\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <label for=\"mod_reference\">Mod Reference:</label>\n      <input\n        id=\"mod_reference\"\n        class=\"base-input\"\n        name=\"mod_reference\"\n        type=\"text\"\n        placeholder=\"Mod Reference\"\n        readonly={editing}\n      />\n      <ValidationMessage for=\"mod_reference\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <label for=\"short_description\">Short Description:</label>\n      <input\n        id=\"short_description\"\n        class=\"base-input\"\n        name=\"short_description\"\n        type=\"text\"\n        placeholder=\"Short Description\"\n      />\n      <ValidationMessage for=\"short_description\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid gap-6 split\">\n      <div class=\"grid grid-flow-row gap-2 auto-rows-max\">\n        <label for=\"full_description\">Full Description:</label>\n        <textarea\n          class=\"base-input\"\n          id=\"full_description\"\n          name=\"full_description\"\n          placeholder=\"Full Description\"\n          rows=\"10\"\n        />\n        <ValidationMessage for=\"full_description\" let:messages={message}>\n          <span class=\"validation-message\">{message || ''}</span>\n        </ValidationMessage>\n      </div>\n      <div class=\"grid grid-flow-row gap-2 auto-rows-max\">\n        <span>Preview:</span>\n        {#await markdown(preview) then previewRendered}\n          <div class=\"markdown-content right\">{@html previewRendered}</div>\n        {/await}\n      </div>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <label for=\"logo\">Logo:</label>\n      <input\n        id=\"logo\"\n        class=\"base-input\"\n        name=\"logo\"\n        type=\"file\"\n        accept=\"image/png,image/jpeg,image/gif\"\n        placeholder=\"Logo\"\n      />\n      <ValidationMessage for=\"logo\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div class=\"grid grid-flow-row gap-2\">\n      <label for=\"source_url\">Source URL:</label>\n      <input id=\"source_url\" class=\"base-input\" name=\"source_url\" type=\"text\" placeholder=\"Source URL\" />\n      <ValidationMessage for=\"source_url\" let:messages={message}>\n        <span class=\"validation-message\">{message || ''}</span>\n      </ValidationMessage>\n    </div>\n\n    <div>\n      <input type=\"submit\" value={submitText} class=\"px-4 py-2 rounded text-base bg-blue-500 cursor-pointer\" />\n    </div>\n  </div>\n</form>\n\n<style lang=\"postcss\">\n  .split {\n    grid-template-columns: 50% 50%;\n\n    & .right {\n      max-height: 75vh;\n      overflow: auto;\n    }\n  }\n</style>\n"],"names":["zod.object","zod.string","zod.optional","zod.any","zod.literal","createForm","validator"],"mappings":"oZAWa,IAAYA,GAAW,CAClC,KAAMC,KAAa,IAAI,GAAG,IAAI,IAC9B,cAAeA,KAEZ,IAAI,GACJ,IAAI,IACJ,MAAM,6BACN,OAAO,SAEC,IAEX,kBAAmBA,KAAa,IAAI,IAAI,IAAI,KAC5C,iBAAkBC,GAAaD,MAC/B,KAAMC,GAAaC,KAAU,OAAO,AAAC,GAAS,QAAU,IAAQ,QAAU,IAAQ,QAAU,KAC5F,WAAYF,KAAa,MAAM,WAAW,GAAGG,GAAY,8BCMjB,OAAW,wKAA7C,sCAAkC,OAAW,wDAeX,OAAW,wKAA7C,sCAAkC,OAAW,wDAcX,OAAW,wKAA7C,sCAAkC,OAAW,wDAeT,OAAW,wKAA7C,sCAAkC,OAAW,mGAMF,wKAA3C,2CAA2C,4GAgBX,OAAW,wKAA7C,sCAAkC,OAAW,wDAQX,OAAW,wKAA7C,sCAAkC,OAAW,wQA3EH,wBAAA,uGAeS,wBAAA,2GAcI,wBAAA,0GAeC,wBAAA,qIAMhD,GAAS,qEAgByB,wBAAA,oGAQM,wBAAA,0FA5EhC,uFAQS,mGAeI,kHAeC,yGAaxB,mEAQU,0FAeM,wPA1EN,2NAQS,uOAeI,kRAeC,iQAaxB,sKAQU,+OAeM,kmBA3DZ,0/BAmEgB,2HArFlC,SACE,OACE,OACE,qBACA,kCAMF,OACE,uBACA,oCAaF,OACE,uBACA,oCAYF,OACE,OACE,uBACA,oCAWF,OACE,wFAOJ,OACE,uBACA,oCAaF,OACE,uBACA,oCAMF,QACE,gJAnEY,0MAqCF,GAAS,qKA8BS,4YArGlC,eACA,gBAAA,WACA,aAAA,aAEA,UAAA,YAEA,OAAA,QAAAC,IACA,gBACA,QAAAC,GAAA,IACA,eAAA,GACA,SAAA,GAAA,EAAA,GAAA,EAAA,wOAGA,EAAA,EAAA,kBAAA"}