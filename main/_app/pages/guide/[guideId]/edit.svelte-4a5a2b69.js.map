{"version":3,"file":"edit.svelte-4a5a2b69.js","sources":["../../../../../../../src/routes/guide/[guideId]/edit.svelte"],"sourcesContent":["<script lang=\"ts\" context=\"module\">\n  import { paramsToProps } from '$lib/utils/routing';\n\n  export const load = paramsToProps();\n</script>\n\n<script lang=\"ts\">\n  import { mutation, operationStore, query } from '@urql/svelte';\n  import { EditGuideDocument, GetGuideDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import GuideForm from '$lib/components/guides/GuideForm.svelte';\n  import type { GuideData } from '$lib/models/guides';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n\n  export let guideId!: string;\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const guide = operationStore(GetGuideDocument, { guide: guideId });\n\n  const editGuide = mutation({\n    query: EditGuideDocument\n  });\n\n  const onSubmit = (data: GuideData) => {\n    editGuide({\n      guideId: guideId,\n      guide: data\n    }).then((value) => {\n      if (value.error) {\n        console.error(value.error.message);\n        errorMessage = 'Error editing guide: ' + value.error.message;\n        errorToast = true;\n      } else {\n        // TODO Toast or something\n        goto(base + '/guide/' + value.data.updateGuide.id);\n      }\n    });\n  };\n\n  $: if (!errorToast) errorMessage = '';\n\n  query(guide);\n</script>\n\n<svelte:head>\n  {#if !$guide.fetching && !$guide.error && $guide.data.getGuide}\n    <MetaDescriptors\n      description=\"Editing guide '{$guide.data.getGuide.short_description}'\"\n      title=\"Edit guide '{$guide.data.getGuide.name}'\" />\n  {/if}\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit Guide</h1>\n\n{#if $guide.fetching}\n  <p>Loading...</p>\n{:else if $guide.error}\n  <p>Oh no... {$guide.error.message}</p>\n{:else}\n  <GuideForm {onSubmit} initialValues={$guide.data.getGuide} submitText=\"Save\" />\n{/if}\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":["ctx","data","getGuide","short_description","name","ctx2","error","message","fetching","load","paramsToProps","guideId","errorMessage","errorToast","guide","operationStore","GetGuideDocument","editGuide","mutation","query","EditGuideDocument","then","value","base","updateGuide","id"],"mappings":"s6BAmDmCA,KAAOC,KAAKC,SAASC,2CAC9BH,KAAOC,KAAKC,SAASE,0IADZC,KAAOJ,KAAKC,SAASC,oDAC9BE,KAAOJ,KAAKC,SAASE,6KAWRJ,KAAOC,KAAKC,4IAAZG,KAAOJ,KAAKC,8HAFpCF,KAAOM,MAAMC,mCAAvB,yDAAA,sFAAUF,KAAOC,MAAMC,0FAFvB,mDAAA,gIAQIP,8CAAAA,4DAAAK,iEAlBDL,KAAOQ,WAAaR,KAAOM,OAASN,KAAOC,KAAKC,2DASnDG,KAAOG,WAEFH,KAAOC,oHAMIN,iBAAAA,gGAVe,qMAAA,6PAP5BK,KAAOG,UAAaH,KAAOC,QAASD,KAAOJ,KAAKC,qUAiBnCG,iMA/DNI,EAAOC,qCAaTC,KAEPC,EAAe,GACfC,GAAa,QAEXC,EAAQC,EAAeC,GAAoBF,MAAOH,+BAElDM,EAAYC,GAChBC,MAAOC,aAqBHN,gFAFED,OAAYD,EAAe,sBAdtBD,QAAAA,EACTG,MAAOb,IACNoB,UACGC,EAAMhB,eACAA,MAAMgB,EAAMhB,MAAMC,aAC1BK,EAAe,wBAA0BU,EAAMhB,MAAMC,aACrDM,GAAa,MAGRU,EAAO,UAAYD,EAAMrB,KAAKuB,YAAYC"}