{"version":3,"file":"edit.svelte-35366705.js","sources":["../../../../../../../src/routes/guide/[guideId]/edit.svelte"],"sourcesContent":["<script lang=\"ts\" context=\"module\">\n  import { paramsToProps } from '$lib/utils/routing';\n  import Card, { Content } from '@smui/card';\n\n  export const load = paramsToProps();\n</script>\n\n<script lang=\"ts\">\n  import { mutation, operationStore, query } from '@urql/svelte';\n  import { EditGuideDocument, GetGuideDocument } from '$lib/generated';\n  import Toast from '$lib/components/general/Toast.svelte';\n  import { goto } from '$app/navigation';\n  import GuideForm from '$lib/components/guides/GuideForm.svelte';\n  import type { GuideData } from '$lib/models/guides';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n\n  export let guideId!: string;\n\n  let errorMessage = '';\n  let errorToast = false;\n\n  const guide = operationStore(GetGuideDocument, { guide: guideId });\n\n  const editGuide = mutation({\n    query: EditGuideDocument\n  });\n\n  const onSubmit = (data: GuideData) => {\n    editGuide({\n      guideId: guideId,\n      guide: data\n    }).then((value) => {\n      if (value.error) {\n        console.error(value.error.message);\n        errorMessage = 'Error editing guide: ' + value.error.message;\n        errorToast = true;\n      } else {\n        // TODO Toast or something\n        goto(base + '/guide/' + value.data.updateGuide.id);\n      }\n    });\n  };\n\n  $: if (!errorToast) errorMessage = '';\n\n  query(guide);\n</script>\n\n<svelte:head>\n  {#if !$guide.fetching && !$guide.error && $guide.data.getGuide}\n    <MetaDescriptors\n      description=\"Editing guide '{$guide.data.getGuide.short_description}'\"\n      title=\"Edit guide '{$guide.data.getGuide.name}'\"\n    />\n  {/if}\n</svelte:head>\n\n<h1 class=\"text-4xl my-4 font-bold\">Edit Guide</h1>\n\n<Card>\n  <Content>\n    {#if $guide.fetching}\n      <p>Loading...</p>\n    {:else if $guide.error}\n      <p>Oh no... {$guide.error.message}</p>\n    {:else}\n      <GuideForm {onSubmit} initialValues={$guide.data.getGuide} submitText=\"Save\" />\n    {/if}\n  </Content>\n</Card>\n\n<Toast bind:running={errorToast}>\n  <span>{errorMessage}</span>\n</Toast>\n"],"names":[],"mappings":"q8BAoDmC,KAAO,KAAK,SAAS,2CAC9B,KAAO,KAAK,SAAS,0IADZ,KAAO,KAAK,SAAS,oDAC9B,KAAO,KAAK,SAAS,+KAcJ,KAAO,KAAK,4IAAZ,KAAO,KAAK,6HAFpC,KAAO,MAAM,qCAAvB,yDAAA,2CAAH,2CAAa,KAAO,MAAM,2FAFvB,mDAAA,mCAAH,qHADG,MAAO,WAEF,KAAO,8pBASZ,8CAAA,2BAAP,iCAAO,gEAvBD,KAAO,WAAa,KAAO,OAAS,KAAO,KAAK,oJAsBnC,2BAAA,+FAde,iNAAA,mMAApC,oEARQ,KAAO,WAAa,KAAO,OAAS,KAAO,KAAK,8OAsBnC,uNApErB,IAAA,+BAaA,aAEA,EAAA,GACA,EAAA,QAEA,GAAA,EAAA,IAAA,MAAA,4BAEA,GAAA,GACA,MAAA,KAGA,EAAA,IACA,GACA,UACA,MAAA,IACA,KAAA,IACA,EAAA,MACA,SAAA,MAAA,EAAA,MAAA,aACA,EAAA,wBAAA,EAAA,MAAA,aACA,EAAA,KAGA,GAAA,GAAA,UAAA,EAAA,KAAA,YAAA,OAOA,EAAA,iBA0BqB,8FA5BrB,QAAA,EAAA"}