{"version":3,"file":"unapproved-mods.svelte-6e4e73b2.js","sources":["../../../../../../src/routes/admin/unapproved-mods.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { ApproveModDocument, DenyModDocument, GetUnapprovedModsDocument } from '$lib/generated';\n  import { mutation, operationStore, query } from '@urql/svelte';\n  import { writable } from 'svelte/store';\n  import PageControls from '$lib/components/utils/PageControls.svelte';\n  import { base } from '$app/paths';\n  import MetaDescriptors from '$lib/components/utils/MetaDescriptors.svelte';\n\n  // TODO Selectable\n  const perPage = 20;\n\n  const mods = operationStore(GetUnapprovedModsDocument, {\n    filter: {\n      offset: 0,\n      limit: perPage\n    }\n  });\n\n  const page = writable(1);\n  let totalMods: number;\n\n  page.subscribe((p) => ($mods.variables.filter.offset = (p - 1) * perPage));\n\n  $: totalMods = $mods?.data?.getUnapprovedMods?.count;\n\n  const approveModMut = mutation({\n    query: ApproveModDocument\n  });\n\n  const approveMod = (modId: string) => {\n    approveModMut({ modId }).then(() => {\n      mods.reexecute();\n    });\n  };\n\n  const denyModMut = mutation({\n    query: DenyModDocument\n  });\n\n  const denyMod = (modId: string) => {\n    denyModMut({ modId }).then(() => {\n      mods.reexecute();\n    });\n  };\n\n  query(mods);\n</script>\n\n<svelte:head>\n  <MetaDescriptors description=\"Unapproved mods\" title=\"Admin: Unapproved Mods\" />\n</svelte:head>\n\n{#if totalMods}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page} />\n  </div>\n{/if}\n\n{#if $mods.fetching}\n  <p>Loading...</p>\n{:else if $mods.error}\n  <p>Oh no... {$mods.error.message}</p>\n{:else}\n  <div class=\"grid grid-cols-6 itemList\">\n    <!-- Header -->\n    <div>Mod</div>\n    <div>Description</div>\n    <div>Release Date</div>\n    <div><!-- Buttons --></div>\n\n    {#each $mods.data.getUnapprovedMods.mods as mod}\n      <div class=\"contents itemHeader\">\n        <div>{mod.name}</div>\n        <div>{mod.short_description}</div>\n        <!-- TODO Pretty Date -->\n        <div>{mod.created_at}</div>\n        <div class=\"grid grid-flow-col gap-4\">\n          <button\n            class=\"py-1 px-4 rounded text-base bg-green-600 text-center cursor-pointer\"\n            on:click={() => approveMod(mod.id)}\n          >\n            Approve\n          </button>\n          <button\n            class=\"py-1 px-4 rounded text-base bg-red-600 text-center cursor-pointer\"\n            on:click={() => denyMod(mod.id)}\n          >\n            Deny\n          </button>\n          <a href={base + '/mod/' + mod.id} class=\"py-1 px-4 rounded text-base bg-blue-500 text-center cursor-pointer\"\n            >View</a\n          >\n        </div>\n      </div>\n    {/each}\n  </div>\n{/if}\n\n{#if totalMods}\n  <div class=\"mt-5 ml-auto flex justify-end\">\n    <PageControls totalPages={Math.ceil(totalMods / perPage)} currentPage={page} />\n  </div>\n{/if}\n\n<style lang=\"postcss\">\n  .itemList {\n    grid-template-columns: auto auto max-content auto;\n\n    & .itemHeader {\n      & > div {\n        @apply border-t-2 border-white p-4;\n      }\n\n      &:hover > div {\n        background: rgba(255, 255, 255, 0.25);\n      }\n    }\n  }\n</style>\n"],"names":[],"mappings":"qsBAsD8B,KAAK,KAAK,KAAY,eAAuB,8LADzE,gEAC4B,KAAK,KAAK,KAAY,iJAgBzC,KAAM,KAAK,kBAAkB,0BAAlC,oEALG,4BACA,oCACA,+JAFA,4DACA,oEACA,oNAJP,SAEE,qBACA,qBACA,qBACA,4EAEO,KAAM,KAAK,kBAAkB,uBAAlC,+HAAA,yDATS,KAAM,MAAM,qCAAtB,yDAAA,2CAAH,2CAAa,KAAM,MAAM,mFAFtB,mDAAA,mCAAH,8DAaY,MAAI,gBACJ,MAAI,6BAEJ,MAAI,yOAKR,mCAMA,2BAIG,+UAVH,2EAMA,6EAIG,gVADM,GAAO,QAAU,MAAI,uMAlBlC,SACE,qBACA,qBAEA,qBACA,OACE,qBAMA,qBAMA,6FAjBI,MAAI,6BACJ,MAAI,0CAEJ,MAAI,mCAcC,GAAO,QAAU,MAAI,0GAWV,KAAK,KAAK,KAAY,eAAuB,8LADzE,gEAC4B,KAAK,KAAK,KAAY,0NAhD/C,kCAMA,MAAM,YAED,KAAM,gCAsCX,oWA9CA,sLA8CA,gRAzFL,GAAA,iCAEA,GAAA,GAAA,IACA,QACA,OAAA,EACA,MAAA,8BAIA,GAAA,GAAA,MACA,GAEA,EAAA,UAAA,QAAA,EAAA,UAAA,OAAA,OAAA,GAAA,GAAA,WAIA,GAAA,IACA,MAAA,KAGA,EAAA,IACA,GAAA,UAAA,UACA,EAAA,eAIA,EAAA,IACA,MAAA,KAGA,EAAA,IACA,GAAA,UAAA,UACA,EAAA,eAIA,GAAA,cAkC4B,EAAW,EAAI,SAMf,EAAQ,EAAI,8CA9DxC,EAAA,GAAA,MAAA,mBAAA"}