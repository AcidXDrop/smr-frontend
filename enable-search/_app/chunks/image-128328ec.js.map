{"version":3,"file":"image-128328ec.js","sources":["../../../../../src/lib/utils/image.ts"],"sourcesContent":["import FastAverageColor from 'fast-average-color';\n\nconst fac = new FastAverageColor();\n\nexport function luminance(r: number, g: number, b: number): number {\n  const a = [r, g, b].map((v) => {\n    v /= 255;\n    return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);\n  });\n  return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;\n}\n\nexport async function getImageCornerColors(element: HTMLImageElement): Promise<{ background: string; light: boolean }> {\n  const halfWidth = element.naturalWidth / 2;\n  const halfHeight = element.naturalHeight / 2;\n\n  // TODO Cleanup\n  return Promise.all([\n    // Top Left\n    new Promise((resolve) => {\n      fac.getColorAsync(element, { width: halfWidth, height: halfHeight }).then((color) => {\n        if (color && 'hex' in color) {\n          resolve(color.hex);\n        }\n      });\n    }),\n    // Top Right\n    new Promise((resolve) => {\n      fac.getColorAsync(element, { width: halfWidth, height: halfHeight, left: halfWidth }).then((color) => {\n        if (color && 'hex' in color) {\n          resolve(color.hex);\n        }\n      });\n    }),\n    // Bottom Left\n    new Promise((resolve) => {\n      fac.getColorAsync(element, { width: halfWidth, height: halfHeight, top: halfHeight }).then((color) => {\n        if (color && 'hex' in color) {\n          resolve(color.hex);\n        }\n      });\n    }),\n    // Bottom Right\n    new Promise((resolve) => {\n      fac\n        .getColorAsync(element, {\n          width: halfWidth,\n          height: halfHeight,\n          left: halfWidth,\n          top: halfHeight\n        })\n        .then((color) => {\n          if (color && 'hex' in color) {\n            resolve(color.hex);\n          }\n        });\n    }),\n    // Lightness\n    new Promise((resolve) => {\n      fac.getColorAsync(element).then((color) => {\n        if (color && 'value' in color) {\n          resolve(color.value);\n        }\n      });\n    })\n  ]).then((colors) => {\n    let result = '';\n    result += `linear-gradient(to bottom right, ${colors[0]}, 35%, transparent),`;\n    result += `linear-gradient(to bottom left, ${colors[1]}, 35%, transparent),`;\n    result += `linear-gradient(to top right, ${colors[2]}, 35%, transparent),`;\n    result += `linear-gradient(to top left, ${colors[3]}, 35%, transparent),`;\n    result += `linear-gradient(rgb(64, 64, 64), rgb(64, 64, 64));`;\n    return {\n      background: result,\n      light: luminance(colors[4][0] as number, colors[4][1] as number, colors[4][2] as number) > 0.4\n    };\n  });\n}\n"],"names":["fac","FastAverageColor","r","g","b","a","map","v","Math","pow","element","halfWidth","naturalWidth","halfHeight","naturalHeight","Promise","all","resolve","getColorAsync","width","height","then","color","hex","left","top","value","colors","result","background","light","luminance"],"mappings":"0CAEA,MAAMA,EAAM,IAAIC,aAEUC,EAAWC,EAAWC,SACxCC,EAAI,CAACH,EAAGC,EAAGC,GAAGE,KAAKC,OAClB,MACO,OAAUA,EAAI,MAAQC,KAAKC,OAAS,MAAS,MAAO,aAEpD,MAAPJ,EAAE,GAAqB,MAAPA,EAAE,GAAqB,MAAPA,EAAE,oBAGAK,SACnCC,EAAYD,EAAQE,aAAe,EACnCC,EAAaH,EAAQI,cAAgB,SAGpCC,QAAQC,IAAI,CAEjB,IAAID,SAASE,MACPC,cAAcR,EAAS,CAAES,MAAOR,EAAWS,OAAQP,IAAcQ,MAAMC,IACrEA,GAAS,QAASA,KACZA,EAAMC,WAKpB,IAAIR,SAASE,MACPC,cAAcR,EAAS,CAAES,MAAOR,EAAWS,OAAQP,EAAYW,KAAMb,IAAaU,MAAMC,IACtFA,GAAS,QAASA,KACZA,EAAMC,WAKpB,IAAIR,SAASE,MACPC,cAAcR,EAAS,CAAES,MAAOR,EAAWS,OAAQP,EAAYY,IAAKZ,IAAcQ,MAAMC,IACtFA,GAAS,QAASA,KACZA,EAAMC,WAKpB,IAAIR,SAASE,MAERC,cAAcR,EAAS,CACtBS,MAAOR,EACPS,OAAQP,EACRW,KAAMb,EACNc,IAAKZ,IAENQ,MAAMC,IACDA,GAAS,QAASA,KACZA,EAAMC,WAKtB,IAAIR,SAASE,MACPC,cAAcR,GAASW,MAAMC,IAC3BA,GAAS,UAAWA,KACdA,EAAMI,eAInBL,MAAMM,QACHC,EAAS,aACH,oCAAoCD,EAAO,4BAC3C,mCAAmCA,EAAO,4BAC1C,iCAAiCA,EAAO,4BACxC,gCAAgCA,EAAO,4BACvC,qDACH,CACLE,WAAYD,EACZE,MAAOC,EAAUJ,EAAO,GAAG,GAAcA,EAAO,GAAG,GAAcA,EAAO,GAAG,IAAgB"}